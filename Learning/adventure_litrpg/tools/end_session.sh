#!/bin/bash

# End Session Script - Checklist for closing a DM session properly
# Ensures nothing is lost when the Claude session ends

echo "==============================================="
echo "SESSION ENDING CHECKLIST"
echo "==============================================="
echo ""
echo "Before closing this session, verify:"
echo ""
echo "âœ“ SESSION.JSON UPDATES:"
echo "  â–¡ Current HP accurate?"
echo "  â–¡ Inventory changes tracked? (items gained/lost)"
echo "  â–¡ Equipment status? (destroyed/damaged items)"
echo "  â–¡ XP and level current?"
echo "  â–¡ Gold amount correct?"
echo "  â–¡ Current location updated?"
echo "  â–¡ Plot threads advanced?"
echo "  â–¡ NPC dispositions/relationships/inventories changed?"
echo "  â–¡ Rage meter reset to 0?"
echo ""
echo "âœ“ RAW NARRATIVE FILE:"
echo "  â–¡ Full session saved to raw/session_XXX.md?"
echo "  â–¡ All dialogue included verbatim?"
echo "  â–¡ Combat scenes fully detailed?"
echo "  â–¡ Character voices preserved?"
echo "  â–¡ No summaries - full novel-style text?"
echo ""
echo "âœ“ SESSION METADATA:"
echo "  â–¡ session.json currentScene has good cliffhanger?"
echo "  â–¡ sessionHistory updated with 1-2 line summary?"
echo "  â–¡ dmNotes updated for next session?"
echo ""
echo "âœ“ CRITICAL ITEMS TO REMEMBER:"
echo "  â–¡ Who has what items? (Steve vs Garrett)"
echo "  â–¡ What clothing/armor needs replacing?"
echo "  â–¡ Any unspent skill/stat points?"
echo "  â–¡ Any unresolved combat/scenes?"
echo ""
echo "==============================================="
echo "FINAL REMINDER:"
echo "The raw/ narrative is the ONLY complete record!"
echo "When this session closes, only those files remain."
echo "==============================================="
echo ""
echo "Type 'done' when checklist is complete, or Ctrl+C to go back:"
read confirmation

if [ "$confirmation" = "done" ]; then
    echo ""
    echo "âœ… Session properly closed!"
    echo "Ready for next adventure. Â¡Dale candela! ðŸ”¥"
    echo ""
    echo "Next session: Run ./start_session.sh speedrun_berserker"
else
    echo "Going back to complete checklist..."
fi